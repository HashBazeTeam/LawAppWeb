(self.webpackChunkLaw_web_app=self.webpackChunkLaw_web_app||[]).push([[788],{75935:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return w}});var a=n(74165),r=n(15861),s=n(29439),i=n(29867),u=n(22030),c=n(84669),o=(n(52506),n(60777)),l=n(69711),d=n(20602),p=n(96493),f=n(68803),x=n(4904),m=n(14175),h=(n(57660),n(82541)),b=n(83692),v=n(20716),g=n(25087),k=(n(38486),n(92834));function w(e){var t=(0,c.k6)(),n=((0,u.I0)(),(0,d.$)().t),w=(window.innerHeight,e.location.state.question),y=(0,i.useRef)(null),D=(0,u.v9)(v.wl.user.selectUserID),I=(0,i.useState)([]),j=(0,s.Z)(I,2),N=j[0],C=j[1],Z=(0,i.useState)(""),q=(0,s.Z)(Z,2),A=q[0],M=q[1],H=(0,i.useState)(!1),Q=(0,s.Z)(H,2),_=(Q[0],Q[1]),S=(0,i.useState)(null),O=(0,s.Z)(S,2),R=O[0];O[1];(0,i.useEffect)((function(){var e=(0,b.IO)((0,b.hJ)(b.RZ,"Question",w.questionID,"chat"));return(0,b.cf)(e,(function(e){var t=[];e.forEach((function(e){var n=e.data(),a=n.author.id==w.clientID?"left":"right",r="text";switch(n.type){case"image":r="photo";break;case"file":r="file";break;default:r="text"}var s="py-2 text-black text-lg";"left"==a?"image"==n.type?s+=" mr-[60%]":s+=" mr-16":"image"==n.type?s+=" ml-[60%]":s+=" ml-16";var i={position:a,type:r,id:n.id,date:new Date(n.createdAt),className:s,text:n.text?n.text:n.name,title:"left"==a?"Client":"Admin",data:{uri:n.uri,className:"w-40",status:{click:!1,loading:0}}};t.push(i)})),C(t),g.MH.updateQuestion(w.questionID,{isReadAdmin:!0})}))}),[]);var z=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t){var n,r,s,i,u;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null===(n=t.target.files)||void 0===n?void 0:n[0]){e.next=3;break}return e.abrupt("return");case 3:if(s=(new Date).valueOf(),20971520,!(r.size>20971520)){e.next=8;break}return l.Am.error("Max file size is 20MB"),e.abrupt("return");case 8:if(i="image",i=r.type.startsWith("image")?"image":"file",u={author:{id:D},createdAt:s,id:s.toString(),type:i,name:r.name,size:r.size,height:720,width:1140,mimeType:r.type},e.prev=11,"Yet to be picked"!=w.status){e.next=17;break}return e.next=15,g.MH.updateQuestion(w.questionID,{status:"Ongoing",isReadClient:!1,adminID:D});case 15:e.next=19;break;case 17:return e.next=19,g.MH.updateQuestion(w.questionID,{isReadClient:!1,adminID:D});case 19:return e.next=21,g.MH.addChatFileToQuestion(w.questionID,r,u);case 21:e.next=27;break;case 23:e.prev=23,e.t0=e.catch(11),console.log(e.t0),l.Am.error("Error uploading file");case 27:case"end":return e.stop()}}),e,null,[[11,23]])})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t){var n,r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""!=A&&A){e.next=3;break}return e.abrupt("return");case 3:if(n=(new Date).valueOf(),r={author:{id:D},createdAt:n,id:n.toString(),type:"text",text:A},e.prev=5,"Yet to be picked"!=w.status){e.next=11;break}return e.next=9,g.MH.updateQuestion(w.questionID,{status:"Ongoing",isReadClient:!1,adminID:D});case 9:e.next=13;break;case 11:return e.next=13,g.MH.updateQuestion(w.questionID,{isReadClient:!1,adminID:D});case 13:return e.next=15,g.MH.addChatToQuestion(w.questionID,r);case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(5),console.log(e.t0);case 20:case"end":return e.stop()}}),e,null,[[5,17]])})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(){var t,r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Answered"!=w.status){e.next=2;break}return e.abrupt("return");case 2:if(_(!0),"Assistance"!=w.status){e.next=15;break}return e.prev=4,e.next=7,g.MH.updateQuestion(w.questionID,{status:"Ended"});case 7:e.next=13;break;case 9:e.prev=9,e.t0=e.catch(4),_(!1),l.Am.error(n("common_error"));case 13:e.next=31;break;case 15:return e.prev=15,e.next=18,g.MH.updateQuestion(w.questionID,{status:"Answered"});case 18:return t=(new Date).valueOf(),r={author:{id:D},createdAt:t,id:t.toString(),type:"text",text:"Answered the question."},e.next=22,g.MH.updateQuestion(w.questionID,{isReadStatus:!1,isReadClient:!1});case 22:return e.next=24,g.MH.addChatToQuestion(w.questionID,r);case 24:e.next=30;break;case 26:e.prev=26,e.t1=e.catch(15),_(!1),l.Am.error(n("common_error"));case 30:_(!1);case 31:case"end":return e.stop()}}),e,null,[[4,9],[15,26]])})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t,n){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.qN)(t,n);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{className:"col-span-1 py-2 flex justify-center align-middle bg-slate-50",children:(0,k.jsxs)(x.u5,{className:" text-md",color:"primary",variant:"outline",onClick:function(){return t.push({pathname:"/law-admin/question/pool",state:{client:{clientID:w.clientID,clientName:w.clientName}}})},children:[(0,k.jsx)(f.Z,{icon:m.j})," ",(0,k.jsx)("span",{className:"text-sm",children:n("show_previous_questions")})]})}),(0,k.jsxs)("div",{className:"mb-4 columns-1 flex flex-col justify-between \n      h-screen bg-slate-50 overflow-y-scroll w-full",children:[(0,k.jsx)(p.rN,{className:"message-list m-1",lockable:!0,toBottomHeight:"100%",dataSource:N,onDownload:function(e){return B(e.data.uri,e.text)}}),(0,k.jsxs)("div",{className:"mb-0 mx-1 sticky bottom-0 grid grid-cols-8 align-middle justify-center ",children:[(0,k.jsx)("div",{className:"col-span-7 shadow border-b border-gray-200",children:(0,k.jsx)(p.II,{className:"m-1 p-1",value:R,onChange:function(e){M(e.target.value)},placeholder:"Type here...",multiline:!0,rightButtons:(0,k.jsx)(p.zx,{className:"mx-2 px-4",color:"white",backgroundColor:"black",text:"Send",onClick:E}),leftButtons:(0,k.jsxs)("button",{id:"recaptcha-container",disabled:!1,onClick:function(){y.current.click()},type:"submit",className:"group relative w-full flex justify-center py-1 px-4\n                    border-transparent text-sm font-medium text-black \n                    ",children:[(0,k.jsx)("input",{style:{display:"none"},ref:y,type:"file",onChange:z}),(0,k.jsx)("span",{className:"absolute left-0 inset-y-0 flex items-center pl-3",children:(0,k.jsx)(o.Z,{className:"h-5 w-5","aria-hidden":"true"})})]})})}),(0,k.jsx)("div",{className:"col-span-1 py-2 flex justify-center align-middle",children:(0,k.jsx)(p.zx,{className:"px-4",color:"white",backgroundColor:"green",text:"Assistance"==w.status?n("finish"):n("submit_answer"),onClick:T})})]})]})]})}},13411:function(e){function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=function(){return[]},t.resolve=t,t.id=13411,e.exports=t},62183:function(){},13024:function(){},62715:function(){},13611:function(){},28353:function(){},1210:function(){},43454:function(){}}]);
//# sourceMappingURL=788.039d7a3d.chunk.js.map