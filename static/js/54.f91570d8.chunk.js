(self.webpackChunkLaw_web_app=self.webpackChunkLaw_web_app||[]).push([[54],{83884:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return I}});var r=n(74165),a=n(15861),s=n(29439),i=n(29867),u=n(22030),c=n(84669),o=(n(52506),n(60777)),l=n(69711),f=n(20602),d=n(96493),p=n(68803),m=n(4904),x=n(14175),h="Yet to be picked",v="Ongoing",b=n(57660),g=n(82541),w=n(83692),k=n(20716),y=n(25087),D=(n(38486),n(92834));function I(e){var t=(0,c.k6)(),n=((0,u.I0)(),(0,f.$)().t),I=(window.innerHeight,e.location.state.question),Z=(0,i.useRef)(null),j=(0,i.useRef)(),N=(0,i.useRef)(),C=(0,u.v9)(k.wl.user.selectUserID),q=(0,i.useState)([]),_=(0,s.Z)(q,2),M=_[0],H=_[1],A=(0,i.useState)(""),S=(0,s.Z)(A,2),O=S[0],Q=S[1],R=(0,i.useState)(!1),E=(0,s.Z)(R,2),T=(E[0],E[1]),z=(0,i.useState)(null),B=(0,s.Z)(z,2),L=(B[0],B[1],(0,i.useState)([])),U=(0,s.Z)(L,2),V=U[0],F=U[1],Y=(0,i.useState)(!1),J=(0,s.Z)(Y,2),W=J[0],$=J[1],G=(0,i.useState)(!1),K=(0,s.Z)(G,2),P=K[0],X=K[1];(0,i.useEffect)((function(){var e=(0,w.IO)((0,w.hJ)(w.RZ,"Question",I.questionID,"chat"));return(0,w.cf)(e,(function(e){var t=[];e.forEach((function(e){var n=e.data(),r=n.author.id==I.clientID?"left":"right",a="text";switch(n.type){case"image":a="photo";break;case"file":a="file";break;default:a="text"}var s="py-2 text-black text-lg";"left"==r?"image"==n.type?s+=" mr-[60%]":s+=" mr-16":"image"==n.type?s+=" ml-[60%]":s+=" ml-16";var i={position:r,type:a,id:n.id,date:new Date(n.createdAt),className:s,text:n.text?n.text:n.name,title:"left"==r?"Client":"Admin",data:{uri:n.uri,className:"w-40",status:{click:!1,loading:0}}};t.push(i)})),H(t),y.MH.updateQuestion(I.questionID,{isReadAdmin:!0})}))}),[]),(0,i.useEffect)((function(){var e=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t,n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.tO.getUserByID(I.clientID);case 2:t=e.sent,console.log(t),n=Object.values(t.fcmToken).filter((function(e){return null!=e&&void 0!=e&&""!=e})),F(n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e().catch((function(e){console.log(e)}))}),[]),(0,i.useEffect)((function(){se()}),[M]),(0,i.useEffect)((function(){I.status==h||I.status==v?X(!0):X(!1)}),[I.status]);var ee=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a,s,i,u;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null===(n=t.target.files)||void 0===n?void 0:n[0]){e.next=3;break}return e.abrupt("return");case 3:if(s=(new Date).valueOf(),20971520,!(a.size>20971520)){e.next=8;break}return l.Am.error("Max file size is 20MB"),e.abrupt("return");case 8:if(i="image",i=a.type.startsWith("image")?"image":"file",u={author:{id:C},createdAt:s,id:s.toString(),type:i,name:a.name,size:a.size,height:720,width:1140,mimeType:a.type},e.prev=11,"Yet to be picked"!=I.status){e.next=17;break}return e.next=15,y.MH.updateQuestion(I.questionID,{status:"Ongoing",isReadClient:!1,adminID:C});case 15:e.next=19;break;case 17:return e.next=19,y.MH.updateQuestion(I.questionID,{isReadClient:!1,adminID:C});case 19:return e.next=21,y.MH.addChatFileToQuestion(I.questionID,a,u);case 21:return e.next=23,y.MH.sendChatNotification(V,I.questionID);case 23:e.next=29;break;case 25:e.prev=25,e.t0=e.catch(11),console.log(e.t0),l.Am.error("Error uploading file");case 29:case"end":return e.stop()}}),e,null,[[11,25]])})));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""!=O&&O){e.next=3;break}return e.abrupt("return");case 3:if(n=(new Date).valueOf(),a={author:{id:C},createdAt:n,id:n.toString(),type:"text",text:O},e.prev=5,"Yet to be picked"!=I.status){e.next=11;break}return e.next=9,y.MH.updateQuestion(I.questionID,{status:"Ongoing",isReadClient:!1,adminID:C});case 9:e.next=13;break;case 11:return e.next=13,y.MH.updateQuestion(I.questionID,{isReadClient:!1,adminID:C});case 13:return e.next=15,y.MH.addChatToQuestion(I.questionID,a);case 15:return N.current.value="",e.next=18,y.MH.sendChatNotification(V,I.questionID);case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(5),console.log(e.t0);case 23:se();case 24:case"end":return e.stop()}}),e,null,[[5,20]])})));return function(t){return e.apply(this,arguments)}}(),ne=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var a,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(T(!0),t.preventDefault(),"Assistance"!=I.status){e.next=14;break}return e.prev=3,e.next=6,y.MH.updateQuestion(I.questionID,{status:"Ended"});case 6:e.next=12;break;case 8:e.prev=8,e.t0=e.catch(3),T(!1),l.Am.error(n("common_error"));case 12:e.next=34;break;case 14:return e.prev=14,$(!1),e.next=18,te(t);case 18:return e.next=20,y.MH.updateQuestion(I.questionID,{status:"Answered"});case 20:return a=(new Date).valueOf(),s={author:{id:C},createdAt:a,id:a.toString(),type:"text",text:"Answered the question."},e.next=24,y.MH.updateQuestion(I.questionID,{isReadStatus:!1,isReadClient:!1});case 24:return e.next=26,y.MH.addChatToQuestion(I.questionID,s);case 26:e.next=32;break;case 28:e.prev=28,e.t1=e.catch(14),T(!1),l.Am.error(n("common_error"));case 32:$(!1),T(!1);case 34:case"end":return e.stop()}}),e,null,[[3,8],[14,28]])})));return function(t){return e.apply(this,arguments)}}(),re=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne(t);case 2:$(!1);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ae=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,g.qN)(t,n);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),se=function(){j.current.scrollIntoView({behavior:"smooth"})};return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)("div",{className:"col-span-1 py-2 flex justify-center align-middle bg-slate-50",children:[(0,D.jsx)(b.u_,{modalVisible:W,setModalVisible:$,successCallback:function(e){return re(e)},successLabel:n("resubmit"),title:n("resubmit_answer"),body:n("are_you_sure_you_want_to_resubmit")}),(0,D.jsxs)(m.u5,{className:" text-md",color:"primary",variant:"outline",onClick:function(){return t.push({pathname:"/law-admin/question/pool",state:{client:{clientID:I.clientID,clientName:I.clientName}}})},children:[(0,D.jsx)(p.Z,{icon:x.j})," ",(0,D.jsx)("span",{className:"text-sm",children:n("show_previous_questions")})]})]}),(0,D.jsxs)("div",{className:"mb-4 columns-1 flex flex-col justify-between \n      h-screen bg-slate-50 overflow-y-scroll w-full",children:[(0,D.jsx)(d.rN,{className:"message-list m-1",lockable:!0,toBottomHeight:"100%",dataSource:M,onDownload:function(e){return ae(e.data.uri,e.text)}}),(0,D.jsx)("div",{ref:j}),(0,D.jsxs)("div",{className:"mb-0  mx-1 sticky bottom-0 grid grid-cols-8 align-middle justify-center ",children:[(0,D.jsx)("div",{className:"col-span-7 ml-4 shadow border-b border-gray-200",children:(0,D.jsx)(d.II,{referance:N,className:"m-1 p-1",defaultValue:O,onChange:function(e){Q(e.target.value)},placeholder:"Type here...",multiline:!0,rightButtons:(0,D.jsx)(d.zx,{className:"mx-2 px-4",color:"white",backgroundColor:"black",text:"Send",onClick:te}),leftButtons:(0,D.jsxs)("button",{id:"recaptcha-container",disabled:!1,onClick:function(){Z.current.click()},type:"submit",className:"group relative w-full flex justify-center py-1 px-4\n                    border-transparent text-sm font-medium text-black \n                    ",children:[(0,D.jsx)("input",{style:{display:"none"},ref:Z,type:"file",onChange:ee}),(0,D.jsx)("span",{className:"absolute left-0 inset-y-0 flex items-center pl-3",children:(0,D.jsx)(o.Z,{className:"h-5 w-5","aria-hidden":"true"})})]})})}),(0,D.jsx)("div",{className:"col-span-1 py-2 flex justify-center align-middle",children:(0,D.jsx)(d.zx,{className:"px-4",color:"white",backgroundColor:P?"green":"grey",text:"Assistance"==I.status?n("finish"):n("submit_answer"),onClick:function(e){console.log(P),P?ne(e):$(!0)}})})]})]})]})}},13411:function(e){function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=function(){return[]},t.resolve=t,t.id=13411,e.exports=t},62183:function(){},13024:function(){},62715:function(){},13611:function(){},28353:function(){},1210:function(){},43454:function(){}}]);
//# sourceMappingURL=54.f91570d8.chunk.js.map